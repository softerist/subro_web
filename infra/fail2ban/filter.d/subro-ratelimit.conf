# Fail2ban filter for Subro Web rate limit abuse
# Only matches rate limits on sensitive authentication endpoints
#
# Log format expected:
# 2026-01-05 10:15:30 SECURITY [RATE_LIMIT] ip=192.168.1.100 endpoint=/api/v1/auth/login

[Definition]
datepattern = ^%%Y-%%m-%%d %%H:%%M:%%S

# Only count rate limits on sensitive auth endpoints
# Avoids false positives from general API rate limiting
failregex = ^.* SECURITY \[RATE_LIMIT\] ip=<HOST> endpoint=/api/v1/auth/.*$

ignoreregex =

[Init]
journalmatch =
