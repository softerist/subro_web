# backend/.env.example - Environment variables template
# Copy this file to .env for local development and fill in secrets.
# DO NOT COMMIT .env file to version control.

# --- General Application Settings ---
DEBUG=True # Set to False in production
# APP_ENV=development # You can keep this if used elsewhere, but DEBUG controls Pydantic settings behavior

# --- FastAPI / Uvicorn ---
# These are typically passed via command line/docker-compose, but can be set here
# API_HOST=0.0.0.0
# API_PORT=8000

# --- Database (PostgreSQL) ---
# Pydantic settings will use DATABASE_URL if set, otherwise it constructs from these parts.
# For local Docker Compose, using individual parts is often clearer.
# Ensure these match your docker-compose service names and credentials.
POSTGRES_SERVER=db
POSTGRES_USER=admin # Corresponds to POSTGRES_USER in docker-compose
POSTGRES_PASSWORD=supersecretpassword # Corresponds to POSTGRES_PASSWORD in docker-compose. CHANGE THIS!
POSTGRES_DB=subappdb # Corresponds to POSTGRES_DB in docker-compose
POSTGRES_PORT=5432

# Optional: Full DATABASE_URL (takes precedence if uncommented).
# Pydantic expects format: postgresql://user:password@host:port/dbname
# The asyncpg driver part ('+asyncpg') is added automatically by config.py
# DATABASE_URL=postgresql://admin:supersecretpassword@db:5432/subappdb

# --- Cache / Broker (Redis) ---
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_DB_CELERY_BROKER=0
REDIS_DB_CELERY_BACKEND=1
REDIS_DB_PUBSUB=2
# Celery uses these directly
CELERY_BROKER_URL=redis://${REDIS_HOST}:${REDIS_PORT}/${REDIS_DB_CELERY_BROKER}
CELERY_RESULT_BACKEND=redis://${REDIS_HOST}:${REDIS_PORT}/${REDIS_DB_CELERY_BACKEND}
# Custom Redis URL for Pub/Sub if needed
REDIS_PUBSUB_URL=redis://${REDIS_HOST}:${REDIS_PORT}/${REDIS_DB_PUBSUB}

# --- Celery Worker ---
DOWNLOAD_SCRIPT_PATH=/app/scripts/sub_downloader.py # Path inside the backend container
JOB_TIMEOUT_SEC=900
JOB_MAX_RETRIES=2
ALLOWED_MEDIA_FOLDERS=/media/movies,/media/tv

# --- Authentication (FastAPI Users / JWT) ---
# Generate a strong 32-byte hex secret using: openssl rand -hex 32
JWT_SECRET_KEY=a_very_long_and_super_secret_key_that_you_must_change_32_chars # CHANGE THIS IN .env!
# JWT_ALGORITHM=HS256 # Algorithm is set in config.py, usually no need to override
ACCESS_TOKEN_EXPIRE_MINUTES=15
REFRESH_TOKEN_EXPIRE_DAYS=7
# Toggle self-service registration (true/false)
OPEN_SIGNUP=True

# --- CORS Origins ---
# Space-separated list of allowed origins for frontend requests (required for browsers)
# Use https://localhost for Caddy local HTTPS, http://localhost:5173 for Vite dev server direct access
BACKEND_CORS_ORIGINS="http://localhost:5173 https://localhost http://127.0.0.1:5173"

# --- Frontend (Informational - Used during frontend build/runtime) ---
# Base URL for the backend API, injected into the frontend build
VITE_API_BASE_URL=https://localhost/api # Matches Caddy's proxy path

# --- Caddy (Optional - Informational) ---
# SITE_DOMAIN=localhost
