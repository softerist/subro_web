# /.env.example - Environment variables template

# Copy this file to .env for local development and fill in secrets.
# DO NOT COMMIT .env file to version control.

# --- General Application Settings ---
# Force setup wizard to run even if already completed (useful for password rotation or re-onboarding)
FORCE_INITIAL_SETUP=false
APP_ENV=development
DEBUG=True # Set to False in production
FIRST_SUPERUSER_EMAIL=admin@example.com
FIRST_SUPERUSER_PASSWORD=CHANGE_ME_SUPERUSER_PASSWORD
ONBOARDING_TOKEN=CHANGE_ME_ONBOARDING_TOKEN
# APP_NAME and APP_VERSION are set as defaults in config.py
APP_PORT=8000

# --- Docker Host Settings ---
PUID=1000
PGID=1000
HOST_MEDIA_PATH=/mnt/usb3/Media/Movies
CONTAINER_MEDIA_PATH=/mnt/usb3/Media/Movies
HOST_DOWNLOADS_PATH=/root/Downloads
CONTAINER_DOWNLOADS_PATH=/downloads
FRONTEND_PORT=5174
REDIS_PORT=6379
CELERY_WORKER_CONCURRENCY=4
CADDY_HTTP_PORT=8090
CADDY_HTTPS_PORT=8444
CADDY_DOCKERFILE=Caddy.Dockerfile
HOST_CADDY_MEDIA_PATH=/mnt/sata0/Media
CONTAINER_CADDY_MEDIA_PATH=/mnt/sata0/Media
HOST_CADDYFILE=./Caddyfile
CONTAINER_CADDYFILE=/etc/caddy/Caddyfile

# --- Database (PostgreSQL) ---
# Pydantic settings (config.py) will use DATABASE_URL if set,
# otherwise it constructs from these individual parts.
# For local Docker Compose, using individual parts is often clearer.
# Ensure these match your docker-compose service names and credentials.
POSTGRES_SERVER=localhost
POSTGRES_USER=admin # Corresponds to POSTGRES_USER in docker-compose
POSTGRES_PASSWORD=CHANGE_ME_DB_PASSWORD # Corresponds to POSTGRES_PASSWORD in docker-compose. CHANGE THIS!
POSTGRES_DB=subappdb # Corresponds to POSTGRES_DB in docker-compose
POSTGRES_PORT=5432

# Optional: Full DATABASE_URL (takes precedence if uncommented and defined in config.py as DATABASE_URL_ENV).
# Pydantic expects format: postgresql://user:password@host:port/dbname
# The asyncpg driver part ('+asyncpg') is added automatically by config.py's ASYNC_DATABASE_URI property.
DATABASE_URL="postgresql+asyncpg://admin:CHANGE_ME_DB_PASSWORD@db:5432/subappdb"

# --- Celery & Redis (Chapter 3) ---
# These URLs are directly read by Pydantic's Settings class.
# Defaults in config.py point to 'redis' service on standard port with different DB numbers.
# You can override them here if needed (e.g., different host, port, or DB numbers).
CELERY_BROKER_URL="redis://redis:6379/0"
CELERY_RESULT_BACKEND="redis://redis:6379/1"
REDIS_PUBSUB_URL="redis://redis:6379/2" # For real-time log streaming

# --- Job Runner Settings (Chapter 3) ---
# DOWNLOAD_SCRIPT_PATH points to the logic inside the worker container
DOWNLOAD_SCRIPT_PATH="/app/scripts/sub_downloader.py"
JOB_TIMEOUT_SEC=900
JOB_MAX_RETRIES=2
SUBPROCESS_TIMEOUT_SECONDS=600
# Example: Comma-separated list of paths the app is allowed to access
ALLOWED_MEDIA_FOLDERS="/media/movies,/media/tvshows"

# --- Authentication (JWT for FastAPI Users & Custom Refresh) ---
# Generate a strong 32-byte hex secret using: openssl rand -hex 32
JWT_SECRET_KEY="CHANGE_ME_JWT_SECRET_KEY"
JWT_REFRESH_SECRET_KEY="CHANGE_ME_JWT_REFRESH_SECRET_KEY"
# Data-at-rest encryption keys (comma-separated). Keep stable across JWT rotations.
DATA_ENCRYPTION_KEYS="CHANGE_ME_DATA_ENCRYPTION_KEY"
# Optional: override reset/verification token secrets
RESET_PASSWORD_TOKEN_SECRET="CHANGE_ME_RESET_PASSWORD_TOKEN_SECRET"
VERIFICATION_TOKEN_SECRET="CHANGE_ME_VERIFICATION_TOKEN_SECRET"
# Generate a strong random value; used to HMAC API keys at rest
API_KEY_PEPPER="CHANGE_ME_API_KEY_PEPPER"
# ALGORITHM is set as default "HS256" in config.py
ACCESS_TOKEN_EXPIRE_MINUTES=15
REFRESH_TOKEN_EXPIRE_DAYS=7
OPEN_SIGNUP=True # Toggle self-service registration (true/false)
COOKIE_SECURE=False

# --- CORS Origins ---
# A JSON string array of allowed origins for frontend requests.
# Example: '["http://localhost:5173","https://your.domain.com"]'
BACKEND_CORS_ORIGINS='["http://localhost:5173", "https://localhost", "http://127.0.0.1:5173"]'

# --- External API Keys ---
DEEPL_API_KEYS=["CHANGE_ME_DEEPL_KEY_1:fx","CHANGE_ME_DEEPL_KEY_2:fx"]
OMDB_API_KEY=CHANGE_ME_OMDB_API_KEY
TMDB_API_KEY=CHANGE_ME_TMDB_API_KEY
OPENSUBTITLES_API_KEY=CHANGE_ME_OPENSUBTITLES_API_KEY
OPENSUBTITLES_USERNAME=CHANGE_ME_OPENSUBTITLES_USERNAME
OPENSUBTITLES_PASSWORD=CHANGE_ME_OPENSUBTITLES_PASSWORD

# --- qBittorrent Settings ---
QBITTORRENT_HOST=127.0.0.1
QBITTORRENT_PORT=8080
QBITTORRENT_USERNAME=admin
QBITTORRENT_PASSWORD=CHANGE_ME_QBITTORRENT_PASSWORD

# --- Google Cloud Translate Settings ---
GOOGLE_PROJECT_ID=CHANGE_ME_GOOGLE_PROJECT_ID
GOOGLE_CREDENTIALS_PATH=/app/secrets/google-api-config.json

# --- Translation Quotas ---
DEEPL_CHARACTER_QUOTA=500000
GOOGLE_CHARACTER_QUOTA=500000

# --- Sync Tool Paths ---
FFSUBSYNC_PATH=ffsubsync
ALASS_CLI_PATH=/usr/local/bin/alass-cli
SUP2SRT_PATH=/usr/local/bin/sup2srt

# --- Other Subtitle Settings ---
NETWORK_MAX_RETRIES=5
NETWORK_BACKOFF_FACTOR=5
FUZZY_MATCH_THRESHOLD=80
SUBTITLE_SYNC_OFFSET_THRESHOLD=1
FFSUBSYNC_CHECK_TIMEOUT=1000
FFSUBSYNC_TIMEOUT=600
ALASS_TIMEOUT=600

# --- Test Database (db_test container) ---
# Used locally by tests and docker-compose.override.yml
DB_TEST_USER=admin
DB_TEST_PASSWORD=CHANGE_ME_TEST_DB_PASSWORD
DB_TEST_DB=subappdb
DB_TEST_PORT=5433

# --- Webhook Settings ---
# Used by backend/scripts/qbittorrent-nox-webhook.sh
SUBRO_API_BASE_URL=http://localhost:8000/api/v1
SUBRO_API_KEY=CHANGE_ME_SUBRO_API_KEY
PLEX_BASE_URL=https://your-plex-host:32400
PLEX_TOKEN=CHANGE_ME_PLEX_TOKEN
PLEX_SECTION_IDS=1,2
PLEX_SECTION_TOKENS=CHANGE_ME_PLEX_TOKEN_1,CHANGE_ME_PLEX_TOKEN_2

# --- Frontend (Vite) ---
#VITE_API_BASE_URL=http://localhost:8000/api/v1
#VITE_WS_BASE_URL=ws://localhost:8000/api/v1

# --- User Agent ---
USER_AGENT_APP_NAME=Subro-Web-Downloader
